# Cross-compilation configuration for ARM targets
#
# Baseline target: Allwinner A33 (Cortex-A7) with NEON + VFPv4
# This configuration also works on:
# - Cortex-A8, A9, A15 (ARMv7-A with NEON)
# - Cortex-A53, A55, A72 (ARMv8-A, backward compatible)
#
# SIMD: Uses std::simd (portable_simd) with explicit f32x4 operations.
# The +neon feature enables ARM NEON codegen for std::simd types.

[target.armv7-unknown-linux-musleabihf]
linker = "arm-linux-gnueabihf-gcc"
rustflags = [
    # CPU targeting - enables NEON for std::simd
    "-C", "target-cpu=cortex-a7",
    "-C", "target-feature=+neon,+vfpv4",

    # Optimization
    "-C", "opt-level=3",
    "-C", "llvm-args=-enable-unsafe-fp-math",

    # Linker
    "-C", "link-arg=-lgcc",
]

# Host machine (macOS/Linux x86_64) - enable AVX2 for development testing
[target.x86_64-apple-darwin]
rustflags = [
    "-C", "target-cpu=native",
]

[target.aarch64-apple-darwin]
rustflags = [
    "-C", "target-cpu=native",
]

# Uncomment for ARM-only development
# [build]
# target = "armv7-unknown-linux-musleabihf"
